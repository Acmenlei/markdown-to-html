function e(e,t=!1){let n=function(e){let t="",n=-1;for(;-1!=(n=e.indexOf("**"));){t+=e.slice(0,n);let s=(e=e.slice(n+2)).indexOf("**");t+=`<strong>${e.slice(0,s)}</strong>`,e=e.slice(s+2)}return e&&(t+=e),t}(e);return n=function(e){let t="",n=-1;for(;-1!=(n=e.indexOf("*"));){t+=e.slice(0,n);let s=(e=e.slice(n+1)).indexOf("*");t+=`<i>${e.slice(0,s)}</i>`,e=e.slice(s+1)}return e&&(t+=e),t}(n),n=function(e){let t="",n=-1;for(;-1!=(n=e.indexOf("`"));){t+=e.slice(0,n);let s=(e=e.slice(n+1)).indexOf("`");t+=`<code class=single-code>${e.slice(0,s)}</code>`,e=e.slice(s+1)}return e&&(t+=e),t}(n),n=function(e){let t="";for(;r.test(e);){let n=e.indexOf("![");t+=e.slice(0,n);let s=(e=e.slice(n+1)).indexOf("]("),r=e.slice(0,s),l=(e=e.slice(s+2)).indexOf(")"),a=e.slice(0,l);e=e.slice(l+1),t+=`<p><img alt=${r} src=${a} /></p>`}return t+e}(n),n=function(e){let t="";for(;s.test(e);){let n=e.indexOf("[");t+=e.slice(0,n);let s=(e=e.slice(n+1)).indexOf("]("),r=e.slice(0,s),l=(e=e.slice(s+2)).indexOf(")"),a=e.slice(0,l);e=e.slice(l+1),t+=`<a href=${a}>${r}</a>`}return t+e}(n),n=function(e){return e.replace(/icon:(\w+)(\s|\b)/g,((e,t)=>`<i class='iconfont icon-${t}'></i>`))}(n),t?n:`<p>${n}</p>`}const t=/(#+)\s(.*)/g,n=/^\s*(\d)\./,s=/\[(.*)\]\((.*)\)/,r=/!\[(.*)\]\((.*)\)/,l=/\/\*(.*)\*\//g,a=/(function)([\s\(&lt])/g;function c(e){/^\s+/.test(e[0])&&(e[0]=e[0].replace(/^(\s+)/g,(e=>"\n"))),e[0].startsWith("\n")||(e[0]="\n"+e[0])}function i(t,n){let s="";for(let r of t){let t=r.children.length?i(r.children,n):"";s+=`<li>${e(r.value+t,!0)}</li>`}return`<${n?"ol":"ul"}>${s}</${n?"ol":"ul"}>`}function u(e){return n.test(e)}function p(e){let t=e.indexOf("-");return 0==t||-1!=t&&!e.slice(0,t).trim()}function o(e){return e.startsWith("```")}function f(e){return e.startsWith("> ")}function d(e,t,n){return e<t-1?n:""}function $(e){return e.startsWith("//")||e.startsWith("/*")||e.startsWith("*")||e.startsWith("#")}function h(e){return"|"===e.trim()[0]}function g(e){return l.test(e)}function m(e){return a.test(e)}function x(e){let t="",n=-1;for(;-1!=(n=e.indexOf('"'))||-1!=(n=e.indexOf("'"));){let s=!1;-1==e.indexOf('"')||(s=!0),t+=e.slice(0,n),e=e.slice(n+1);let r=s?e.indexOf('"'):e.indexOf("'");t+=`<q class=declare-string>${e.slice(0,r)}</q>`,e=e.slice(r+1)}return e&&(t+=e),t}function w(e){return e.replace(/([^\w])(false|true)(?!\w)/g,((e,t,n)=>`${t}<span class=declare-boolean>${n}</span>`))}function y(e){return e.replace(/([^\w])(\d+)(?![\w\.])/g,((e,t,n)=>`${t}<span class=declare-number>${n}</span>`))}function v(e){return e.replace(/(\s*null)(?!\w)/g,((e,t)=>`<span class=declare-operator-char>${t}</span>`))}function O(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function b(e,t){return t?`<span class=line-number>${e}</span>`:""}function I(e){return e.trim().startsWith("::: start")}function E(e){return e.trim().startsWith(":::")}function W(e){return e.trim().startsWith("::: headStart")}function k(e,t,n){let s="",r=e.split("\n");for(let e=0;e<r.length;e++){s+=R(O(r[e]),t++,n)}return s}function R(e,t,n){let s=[],r="",l=0,a="",c=(e=x(e)).length;for(let t=0;t<c;t++)if(")"==e[t]){let e="";for(;s.length&&"("!=(e=s.pop());)r=e+r;"("!=e?s.push(j(r+")",!1)):(l--,s.push(j(r,!0))),r=""}else"("==e[t]&&l++,s.push(e[t]);let i=0;for(;l--;)i=s.lastIndexOf("("),a="("+j(s.slice(i+1).join(""),!1)+a,s=s.slice(0,i);return s.length&&(a=j(s.join(""),!1)+a),`<p>${b(t,n.lineNumber)}<span>${a}</span></p>`}function j(e,t){if(!e.trim())return t?`(${e})`:e;if($(e.trim()))return`<span class=declare-comments>${e}</span>`;let n=e;return n=B(n),n=x(n),n=N(n),n=function(e){if(g(e))return B(e);return e.replace(/(class|await|in|of|typeof|module|async|this|as|super|module|export\s+default|export|import|from|while|extends|new|abstract|void|static|return|break|continue|switch|case|finally|try|catch|else|if|throw)(?=[\s+\(\.])/g,((e,t)=>`<span class=declare-operator-char>${t}</span>`))}(n),n=function(e){if(!e.includes("=>"))return e;return e.replace(/=>/g,(e=>`<span class=declare-arrow-func>${e}</span>`))}(n),n=n.replace(/(\w+)(\s*)\(/g,((e,t,n)=>`<span class=declare-func-execute>${t}</span>${n}(`)),n=S(n),n=w(n),n=y(n),n=v(n),t?`(${n})`:n}function N(e){if(/^(const|int|string|var|let)/.test(e.trim())){if(/(\w+\s+)(.*\s*)=(.*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)=(.*)/,((e,t,n,s)=>`${A(t)}${q(n)}=${N(s)}`));if(/(\w+\s+)(.*\s*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)/,((e,t,n,s)=>`${A(t)}${q(n)}`))}let t="",n=e.split(",");for(let e=0,s=n.length;e<s;e++)t+=`${q(n[e])}${d(e,s,",")}`;return t}function q(e){return/(\s*\w+\s*)?:(\s*\w+\s*)/.test(e)?e.replace(/(\s*\w+\s*)?:(\s*\w+\s*)/,((e,t,n)=>t?`<span class=declare-param>${t}</span>:<span class=declare-param-type>${n}</span>`:`:<span class=declare-param-type>${n}</span>`)):m(e)?S(e):e}function S(e){return e.replace(a,((e,t,n)=>`<span class=declare-function>${t}</span>${n}`))}function A(e){return e.replace(/(const|let|var)(\s+)/gi,((e,t,n)=>`<span class=declare-keyword>${t}</span><span class=declare-constant-name>${n}</span>`))}function B(e){return e.replace(l,(e=>`<span class=declare-comments>${e}</span>`))}function Z(e,t){return`<p class=line-code>${b(e,t.lineNumber)}`}function C(e){let t="";for(let n=0,s=e.length;n<s;n++){let r=e[n];if(!r.trim()){t+=r;continue}let l=r.indexOf("=");if(-1!=l){t+=`<span class=declare-attr-key>${r.slice(0,l)}</span>=<span class=declare-attr-value>${r.slice(l+1)}</span>${d(n,s,"&nbsp;")}`}else t+=r}return t}function L(){return""}function z(e,t,n){let s=[],r="",l=0,a="";for(let t=0;t<e.length;t++)if(")"==e[t]){let e="";for(;s.length&&"("!=(e=s.pop());)r=e+r;"("!=e?s.push(D(r+")",!1)):(l--,s.push(D(r,!0))),r=""}else"("==e[t]&&l++,s.push(e[t]);let c=0;for(;l--;)c=s.lastIndexOf("("),a="("+D(s.slice(c+1).join(""),!1)+a,s=s.slice(0,c);return s.length&&(a=D(s.join(""),!1)+a),`<p>${b(t,n.lineNumber)}<span>${a}</span></p>`}function D(e,t){if(!e.trim())return t?`(${e})`:e;if($(e.trim()))return`<span class=declare-comments>${e}</span>`;let n=e;return n=M(n),n=F(n),n=function(e){if(g(e))return M(e);return e.replace(/(class|in|of|this|super|interface|module|import|from|extends|new|abstract|void|static|return|break|continue|switch|case|finally|try|catch|else|if|throw)(?=[\s\(\.])/g,((e,t)=>`<span class=declare-operator-char>${t}</span>`))}(n),n=x(n),n=n.replace(/(\w+)(\s*)\(/g,((e,t,n)=>`<span class=declare-func-execute>${t}</span>${n}(`)),n=w(n),n=y(n),n=v(n),t?`(${n})`:n}function F(e){if(/^(char|int|String|Byte\[?\]?|[A-Z]+)/.test(e.trim())){if(/(\w+\s+)(.*\s*)=(.*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)=(.*)/,((e,t,n,s)=>`${K(t)}${J(n)}=${F(s)}`));if(/(\w+\s+)(.*\s*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)/,((e,t,n,s)=>`${K(t)}${J(n)}`))}let t="",n=e.split(",");for(let e=0,s=n.length;e<s;e++)t+=`${J(n[e])}${d(e,s,",")}`;return t}const G=/(\s*\w+\s*)?:(\s*\w+\s*)/g,H=/(:\s*\w+\s*)?&lt;(\s*\/?\s*\w+\s*)&gt;/g;function J(e){return H.test(e)?e.replace(H,((e,t,n)=>`${t?`<span class=declare-param-type>${t}</span>`:""}&lt;<span class=declare-param-type>${n}</span>&gt;`)):G.test(e)?e.replace(G,((e,t,n)=>t?`<span class=declare-param>${t}</span>:<span class=declare-param-type>${n}</span>`:`:<span class=declare-param-type>${n}</span>`)):e}function K(e){return e.replace(/(const|let|var|int|string|Byte\[?\]?|[A-Z]+)(\s+)/gi,((e,t,n)=>`<span class=declare-keyword>${t}</span><span class=declare-constant-name>${n}</span>`))}function M(e){return e.replace(l,(e=>`<span class=declare-comments>${e}</span>`))}function P(e,t,n){let s="",r=e.split("\n");for(let e=0;e<r.length;e++){s+=Q(O(r[e]),t++,n)}return s}function Q(e,t,n){let s=[],r="",l=0,a="";for(let t=0;t<e.length;t++)if(")"==e[t]){let e="";for(;s.length&&"("!=(e=s.pop());)r=e+r;"("!=e?s.push(T(r+")",!1)):(l--,s.push(T(r,!0))),r=""}else"("==e[t]&&l++,s.push(e[t]);let c=0;for(;l--;)c=s.lastIndexOf("("),a="("+T(s.slice(c+1).join(""),!1)+a,s=s.slice(0,c);return s.length&&(a=T(s.join(""),!1)+a),`<p>${b(t,n.lineNumber)}<span>${a}</span></p>`}function T(e,t){if(!e.trim())return t?`(${e})`:e;if($(e.trim()))return`<span class=declare-comments>${e}</span>`;let n=e;return n=te(n),n=U(n),n=function(e){if(g(e))return te(e);return e.replace(/(class|in|of|this|super|interface|typeof|module|declare|type|keyof|infer|export\s+default|export|import|from|extends|new|abstract|void|static|return|break|continue|switch|case|finally|try|catch|else|if|throw)(?=[\s\(\.])/g,((e,t)=>`<span class=declare-operator-char>${t}</span>`))}(n),n=x(n),n=function(e){if(!e.includes("=>"))return e;return e.replace(/=>/g,(e=>`<span class=declare-arrow-func>${e}</span>`))}(n),n=n.replace(/(\w+)(\s*)\(/g,((e,t,n)=>`<span class=declare-func-execute>${t}</span>${n}(`)),n=_(n),n=w(n),n=y(n),n=v(n),t?`(${n})`:n}function U(e){if(/^(const|int|string|var|let)/.test(e.trim())){if(/(\w+\s+)(.*\s*)=(.*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)=(.*)/,((e,t,n,s)=>`${ee(t)}${Y(n)}=${U(s)}`));if(/(\w+\s+)(.*\s*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)/,((e,t,n,s)=>`${ee(t)}${Y(n)}`))}let t="",n=e.split(",");for(let e=0,s=n.length;e<s;e++)t+=`${Y(n[e])}${d(e,s,",")}`;return t}const V=/(\s*\w+\s*)?:(\s*\w+\s*)/g,X=/(:\s*\w+\s*)?&lt;(\s*\/?\s*\w+\s*)&gt;/g;function Y(e){return X.test(e)?e.replace(X,((e,t,n)=>`${t?`<span class=declare-param-type>${t}</span>`:""}&lt;<span class=declare-param-type>${n}</span>&gt;`)):V.test(e)?e.replace(V,((e,t,n)=>t?`<span class=declare-param>${t}</span>:<span class=declare-param-type>${n}</span>`:`:<span class=declare-param-type>${n}</span>`)):m(e)?_(e):e}function _(e){return e.replace(a,((e,t,n)=>`<span class=declare-function>${t}</span>${n}`))}function ee(e){return e.replace(/(const|let|var|int|string)(\s+)/gi,((e,t,n)=>`<span class=declare-keyword>${t}</span><span class=declare-constant-name>${n}</span>`))}function te(e){return e.replace(l,(e=>`<span class=declare-comments>${e}</span>`))}const ne={java:function(e,t,n){let s="",r=e.split("\n");for(let e=0;e<r.length;e++){s+=z(r[e],t++,n)}return s},c:L,"c++":L,"c#":L,js:k,javascript:k,ts:P,typescript:P,html:function(e,t,n){if(/(<!--.*-->)/g.test(e))return`${Z(t,n)}<span class=declare-comments>${O(RegExp.$1)}</span></p>`;if(/(\s*)<(\!?\w+)(.*)>(.*)<\/\w+>/g.test(e)){let e=C(RegExp.$3.trim().split(" "));return`${Z(t,n)}${RegExp.$1}&lt<span class=declare-html-tag>${RegExp.$2}</span>${e&&"&nbsp;"+e}&gt${RegExp.$4}&lt/<span class=declare-html-tag>${RegExp.$2}</span>&gt</p>`}if(/(\s*)<(\!?\w+)(.*)>/g.test(e)){let e=C(RegExp.$3.trim().split(" "));return`${Z(t,n)}${RegExp.$1}&lt<span class=declare-html-tag>${RegExp.$2}</span>${e&&"&nbsp;"+e}&gt</p>`}return/(\s*)<\/(\w+)>/g.test(e)?`${Z(t,n)}${RegExp.$1}&lt/<span class=declare-html-tag>${RegExp.$2}</span>&gt</p>`:k(e,t++,n)}};function se(e,t,n,s){let r="",l=e[t].slice(3).trim().toLowerCase(),a=1;for(++t;t<n&&!e[t].startsWith("```");)r+=s.highlight?ne[l](e[t],a++,s):e[t]+"\n",t++;return e[t]="",{startIdx:t,result:s.highlight?`<pre><span class=language>${l}</span><code>${r}</code></pre>`:`<pre><code>${r}</code></pre>`}}function re(e,t,n){let s="";for(;t<n;t++)if(e[t].trim()){if("-"!==e[t].trim()[0]||-1==e[t].indexOf("-"))break;s+=e[t]+"\n"}return s=function(e){const t=e.match(/(\s?)+-\s(.*)/g);if(!t)return e;c(t);const n=function(e){const t=[],n=[],s=e.length;for(let r=0;r<s;r++){const s=e[r].indexOf("-"),l={children:[],value:e[r].slice(s+1),level:s,parent:null};if(!n.length){t.push(l),n.push(l);continue}const a=n[n.length-1].level,c=e[r].indexOf("-");let i;if(a===c)i=n[n.length-1].parent;else if(a>c){for(;n[n.length-1].level>c;)n.pop();i=n[n.length-1].parent}else i=n[n.length-1];l.parent=i,i?i.children.push(l):t.push(l),n.push(l)}return t}(t);return i(n,!1)}(s),{startIdx:t,result:s}}function le(e,t,s){let r="";for(;t<s;t++)if(e[t].trim()){if(!n.test(e[t]))break;r+=e[t]+"\n"}return r=function(e){const t=e.match(/\s*\d\.(.*)/g);if(!t)return e;c(t);const s=function(e){const t=[],s=[],r=e.length;for(let l=0;l<r;l++){let r=0;n.test(e[l])&&(r=e[l].indexOf(String(RegExp.$1+".")));const a={children:[],value:e[l].slice(r+2),level:r,parent:null};if(!s.length){t.push(a),s.push(a);continue}const c=s[s.length-1].level,i=r;let u;if(c===i)u=s[s.length-1].parent;else if(c>i){for(;s[s.length-1].level>i;)s.pop();u=s[s.length-1].parent}else u=s[s.length-1];a.parent=u,u?u.children.push(a):t.push(a),s.push(a)}return t}(t);return i(s,!0)}(r),{startIdx:t,result:r}}function ae(e){return e.length>6?6:e.length}function ce(n){return n.trim().replace(t,((t,n,s)=>`<h${ae(n)}>${e(s,!0)}</h${ae(n)}>`))}function ie(e,t,n){let s="<table>";for(s+=function(e){let t=-1,n="<thead><tr>";for(let s=0,r=e.length;s<r;s++)"|"==e[s]&&pe(e,s-1)&&pe(e,s+1)&&(-1!=t&&(n+=`<th>${e.slice(t+1,s)}</th>`),t=s);return n+"</tr></thead>"}(e[t]),s+="<tbody >",++t;t<n&&"|"===e[t].trim()[0];t++)s+=ue(e[t]);return s+="</tbody></table>",{startIdx:t-1,result:s}}function ue(e){let t=-1,n="<tr>";for(let s=0,r=e.length;s<r;s++)if("|"==e[s]&&pe(e,s-1)&&pe(e,s+1)){if(-1!=t){let r=e.slice(t+1,s);if("-"===r.trim()[0])continue;n+=`<td>${r}</td>`}t=s}return n+"</tr>"}function pe(e,t){return" "===e[t]||null==e[t]}function oe(e,t,n){let s="<div class=flex-layout>",r="";for(++t;t<n&&!e[t].trim().startsWith("::: end");)E(e[t])?(s+=`<div class=flex-layout-item>${$e(r)}</div>`,r=""):r+=e[t].trim()?e[t]+"\n":"",t++;return s+=`<div class=flex-layout-item>${$e(r)}</div>`,s+="</div>",{result:s,startIdx:t}}function fe(e,t,n){let s="<div class=head-layout>";for(++t;t<n&&!e[t].trim().startsWith("::: headEnd");)if(I(e[t])){const{startIdx:r,result:l}=oe(e,t,n);s+=l,t=r+1}else s+=e[t].trim()?$e(e[t]):"",t++;return s+="</div>",{result:s,startIdx:t}}const de={lineNumber:!1,highlight:!1};function $e(t,n){const s=t.split("\n");let r="",l=(null==s?void 0:s.length)||0;for(let t=0;t<l;){if(-1!=s[t].indexOf("#"))r+=ce(s[t]);else if(W(s[t])){const{result:e,startIdx:n}=fe(s,t,l);t=n,r+=e}else if(I(s[t])){const{result:e,startIdx:n}=oe(s,t,l);t=n,r+=e}else if(h(s[t])){const{result:e,startIdx:n}=ie(s,t,l);t=n,r+=e}else if(p(s[t])){const{result:e,startIdx:n}=re(s,t,l);t=n-1,r+=e}else if(u(s[t])){const{result:e,startIdx:n}=le(s,t,l);t=n-1,r+=e}else if(o(s[t])){const{result:e,startIdx:a}=se(s,t,l,n||de);t=a,r+=e}else f(s[t])?r+=`<blockquote>${s[t].slice(2)}</blockquote>`:(s[t]=s[t].trim())&&(r+=e(s[t]));t++}return r}export{$e as markdownToHTML};
