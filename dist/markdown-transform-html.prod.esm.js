function e(e){let t=function(e){let t="",n=-1;for(;-1!=(n=e.indexOf("**"));){t+=e.slice(0,n);let s=(e=e.slice(n+2)).indexOf("**");t+=`<strong>${e.slice(0,s)}</strong>`,e=e.slice(s+2)}return e&&(t+=e),t}(e);return t=function(e){let t="",n=-1;for(;-1!=(n=e.indexOf("*"));){t+=e.slice(0,n);let s=(e=e.slice(n+1)).indexOf("*");t+=`<i>${e.slice(0,s)}</i>`,e=e.slice(s+1)}return e&&(t+=e),t}(t),t=function(e){let t="",n=-1;for(;-1!=(n=e.indexOf("`"));){t+=e.slice(0,n);let s=(e=e.slice(n+1)).indexOf("`");t+=`<code class=single-code>${e.slice(0,s)}</code>`,e=e.slice(s+1)}return e&&(t+=e),t}(t),t=function(e){let t="";for(;s.test(e);){let n=e.indexOf("[");t+=e.slice(0,n);let s=(e=e.slice(n+1)).indexOf("]("),r=e.slice(0,s),l=(e=e.slice(s+2)).indexOf(")"),a=e.slice(0,l);e=e.slice(l+1),t+=`<a href=${a}>${r}</a>`}return t+e}(t),t=function(e){let t="";for(;r.test(e);){let n=e.indexOf("![");t+=e.slice(0,n);let s=(e=e.slice(n+1)).indexOf("]("),r=e.slice(0,s),l=(e=e.slice(s+2)).indexOf(")"),a=e.slice(0,l);e=e.slice(l+1),t+=`<p><img alt=${r} src=${a} /></p>`}return t+e}(t),t=function(e){return e.replace(/icon:(\w+)\s/g,((e,t)=>`<i class='iconfont icon-${t}'></i>`))}(t),`${t}`}const t=/(#+)\s(.*)/g,n=/^\s*(\d)\./,s=/\[(.*)\]\((.*)\)/,r=/!\[(.*)\]\((.*)\)/,l=/\/\*(.*)\*\//g,a=/(function)([\s\(&lt])/g;function c(e){/^\s+/.test(e[0])&&(e[0]=e[0].replace(/^(\s+)/g,(e=>"\n"))),e[0].startsWith("\n")||(e[0]="\n"+e[0])}function i(t,n){let s="";for(let r of t){let t=r.children.length?i(r.children,n):"";s+=`<li>${e(r.value+t)}</li>`}return`<${n?"ol":"ul"}>${s}</${n?"ol":"ul"}>`}function p(e){return n.test(e)}function u(e){let t=e.indexOf("-");return 0==t||-1!=t&&!e.slice(0,t).trim()}function o(e){return e.startsWith("```")}function f(e){return e.startsWith("> ")}function $(e,t,n){return e<t-1?n:""}function d(e){return e.startsWith("//")||e.startsWith("/*")||e.startsWith("*")||e.startsWith("#")}function h(e){return"|"===e.trim()[0]}function g(e){return l.test(e)}function m(e){return a.test(e)}function x(e){let t="",n=-1;for(;-1!=(n=e.indexOf('"'))||-1!=(n=e.indexOf("'"));){let s=!1;-1==e.indexOf('"')||(s=!0),t+=e.slice(0,n),e=e.slice(n+1);let r=s?e.indexOf('"'):e.indexOf("'");t+=`<q class=declare-string>${e.slice(0,r)}</q>`,e=e.slice(r+1)}return e&&(t+=e),t}function w(e){return e.replace(/([^\w])(false|true)(?!\w)/g,((e,t,n)=>`${t}<span class=declare-boolean>${n}</span>`))}function y(e){return e.replace(/([^\w])(\d+)(?![\w\.])/g,((e,t,n)=>`${t}<span class=declare-number>${n}</span>`))}function v(e){return e.replace(/(\s*null)(?!\w)/g,((e,t)=>`<span class=declare-operator-char>${t}</span>`))}function O(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function b(e,t){return t?`<span class=line-number>${e}</span>`:""}function I(e){return e.startsWith("::: start")}function E(e){return e.startsWith(":::")}function R(e,t,n){let s="",r=e.split("\n");for(let e=0;e<r.length;e++){s+=W(O(r[e]),t++,n)}return s}function W(e,t,n){let s=[],r="",l=0,a="",c=(e=x(e)).length;for(let t=0;t<c;t++)if(")"==e[t]){let e="";for(;s.length&&"("!=(e=s.pop());)r=e+r;"("!=e?s.push(k(r+")",!1)):(l--,s.push(k(r,!0))),r=""}else"("==e[t]&&l++,s.push(e[t]);let i=0;for(;l--;)i=s.lastIndexOf("("),a="("+k(s.slice(i+1).join(""),!1)+a,s=s.slice(0,i);return s.length&&(a=k(s.join(""),!1)+a),`<p>${b(t,n.lineNumber)}<span>${a}</span></p>`}function k(e,t){if(!e.trim())return t?`(${e})`:e;if(d(e.trim()))return`<span class=declare-comments>${e}</span>`;let n=e;return n=B(n),n=x(n),n=j(n),n=function(e){if(g(e))return B(e);return e.replace(/(class|await|in|of|typeof|module|async|this|as|super|module|export\s+default|export|import|from|while|extends|new|abstract|void|static|return|break|continue|switch|case|finally|try|catch|else|if|throw)(?=[\s+\(\.])/g,((e,t)=>`<span class=declare-operator-char>${t}</span>`))}(n),n=function(e){if(!e.includes("=>"))return e;return e.replace(/=>/g,(e=>`<span class=declare-arrow-func>${e}</span>`))}(n),n=n.replace(/(\w+)(\s*)\(/g,((e,t,n)=>`<span class=declare-func-execute>${t}</span>${n}(`)),n=q(n),n=w(n),n=y(n),n=v(n),t?`(${n})`:n}function j(e){if(/^(const|int|string|var|let)/.test(e.trim())){if(/(\w+\s+)(.*\s*)=(.*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)=(.*)/,((e,t,n,s)=>`${A(t)}${N(n)}=${j(s)}`));if(/(\w+\s+)(.*\s*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)/,((e,t,n,s)=>`${A(t)}${N(n)}`))}let t="",n=e.split(",");for(let e=0,s=n.length;e<s;e++)t+=`${N(n[e])}${$(e,s,",")}`;return t}function N(e){return/(\s*\w+\s*)?:(\s*\w+\s*)/.test(e)?e.replace(/(\s*\w+\s*)?:(\s*\w+\s*)/,((e,t,n)=>t?`<span class=declare-param>${t}</span>:<span class=declare-param-type>${n}</span>`:`:<span class=declare-param-type>${n}</span>`)):m(e)?q(e):e}function q(e){return e.replace(a,((e,t,n)=>`<span class=declare-function>${t}</span>${n}`))}function A(e){return e.replace(/(const|let|var)(\s+)/gi,((e,t,n)=>`<span class=declare-keyword>${t}</span><span class=declare-constant-name>${n}</span>`))}function B(e){return e.replace(l,(e=>`<span class=declare-comments>${e}</span>`))}function S(e,t){return`<p class=line-code>${b(e,t.lineNumber)}`}function Z(e){let t="";for(let n=0,s=e.length;n<s;n++){let r=e[n];if(!r.trim()){t+=r;continue}let l=r.indexOf("=");if(-1!=l){t+=`<span class=declare-attr-key>${r.slice(0,l)}</span>=<span class=declare-attr-value>${r.slice(l+1)}</span>${$(n,s,"&nbsp;")}`}else t+=r}return t}function C(){return""}function L(e,t,n){let s=[],r="",l=0,a="";for(let t=0;t<e.length;t++)if(")"==e[t]){let e="";for(;s.length&&"("!=(e=s.pop());)r=e+r;"("!=e?s.push(z(r+")",!1)):(l--,s.push(z(r,!0))),r=""}else"("==e[t]&&l++,s.push(e[t]);let c=0;for(;l--;)c=s.lastIndexOf("("),a="("+z(s.slice(c+1).join(""),!1)+a,s=s.slice(0,c);return s.length&&(a=z(s.join(""),!1)+a),`<p>${b(t,n.lineNumber)}<span>${a}</span></p>`}function z(e,t){if(!e.trim())return t?`(${e})`:e;if(d(e.trim()))return`<span class=declare-comments>${e}</span>`;let n=e;return n=K(n),n=D(n),n=function(e){if(g(e))return K(e);return e.replace(/(class|in|of|this|super|interface|module|import|from|extends|new|abstract|void|static|return|break|continue|switch|case|finally|try|catch|else|if|throw)(?=[\s\(\.])/g,((e,t)=>`<span class=declare-operator-char>${t}</span>`))}(n),n=x(n),n=n.replace(/(\w+)(\s*)\(/g,((e,t,n)=>`<span class=declare-func-execute>${t}</span>${n}(`)),n=w(n),n=y(n),n=v(n),t?`(${n})`:n}function D(e){if(/^(char|int|String|Byte\[?\]?|[A-Z]+)/.test(e.trim())){if(/(\w+\s+)(.*\s*)=(.*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)=(.*)/,((e,t,n,s)=>`${J(t)}${H(n)}=${D(s)}`));if(/(\w+\s+)(.*\s*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)/,((e,t,n,s)=>`${J(t)}${H(n)}`))}let t="",n=e.split(",");for(let e=0,s=n.length;e<s;e++)t+=`${H(n[e])}${$(e,s,",")}`;return t}const F=/(\s*\w+\s*)?:(\s*\w+\s*)/g,G=/(:\s*\w+\s*)?&lt;(\s*\/?\s*\w+\s*)&gt;/g;function H(e){return G.test(e)?e.replace(G,((e,t,n)=>`${t?`<span class=declare-param-type>${t}</span>`:""}&lt;<span class=declare-param-type>${n}</span>&gt;`)):F.test(e)?e.replace(F,((e,t,n)=>t?`<span class=declare-param>${t}</span>:<span class=declare-param-type>${n}</span>`:`:<span class=declare-param-type>${n}</span>`)):e}function J(e){return e.replace(/(const|let|var|int|string|Byte\[?\]?|[A-Z]+)(\s+)/gi,((e,t,n)=>`<span class=declare-keyword>${t}</span><span class=declare-constant-name>${n}</span>`))}function K(e){return e.replace(l,(e=>`<span class=declare-comments>${e}</span>`))}function M(e,t,n){let s="",r=e.split("\n");for(let e=0;e<r.length;e++){s+=P(O(r[e]),t++,n)}return s}function P(e,t,n){let s=[],r="",l=0,a="";for(let t=0;t<e.length;t++)if(")"==e[t]){let e="";for(;s.length&&"("!=(e=s.pop());)r=e+r;"("!=e?s.push(Q(r+")",!1)):(l--,s.push(Q(r,!0))),r=""}else"("==e[t]&&l++,s.push(e[t]);let c=0;for(;l--;)c=s.lastIndexOf("("),a="("+Q(s.slice(c+1).join(""),!1)+a,s=s.slice(0,c);return s.length&&(a=Q(s.join(""),!1)+a),`<p>${b(t,n.lineNumber)}<span>${a}</span></p>`}function Q(e,t){if(!e.trim())return t?`(${e})`:e;if(d(e.trim()))return`<span class=declare-comments>${e}</span>`;let n=e;return n=ee(n),n=T(n),n=function(e){if(g(e))return ee(e);return e.replace(/(class|in|of|this|super|interface|typeof|module|declare|type|keyof|infer|export\s+default|export|import|from|extends|new|abstract|void|static|return|break|continue|switch|case|finally|try|catch|else|if|throw)(?=[\s\(\.])/g,((e,t)=>`<span class=declare-operator-char>${t}</span>`))}(n),n=x(n),n=function(e){if(!e.includes("=>"))return e;return e.replace(/=>/g,(e=>`<span class=declare-arrow-func>${e}</span>`))}(n),n=n.replace(/(\w+)(\s*)\(/g,((e,t,n)=>`<span class=declare-func-execute>${t}</span>${n}(`)),n=Y(n),n=w(n),n=y(n),n=v(n),t?`(${n})`:n}function T(e){if(/^(const|int|string|var|let)/.test(e.trim())){if(/(\w+\s+)(.*\s*)=(.*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)=(.*)/,((e,t,n,s)=>`${_(t)}${X(n)}=${T(s)}`));if(/(\w+\s+)(.*\s*)/.test(e))return e.replace(/(\s*\w+\s+)(.*\s*)/,((e,t,n,s)=>`${_(t)}${X(n)}`))}let t="",n=e.split(",");for(let e=0,s=n.length;e<s;e++)t+=`${X(n[e])}${$(e,s,",")}`;return t}const U=/(\s*\w+\s*)?:(\s*\w+\s*)/g,V=/(:\s*\w+\s*)?&lt;(\s*\/?\s*\w+\s*)&gt;/g;function X(e){return V.test(e)?e.replace(V,((e,t,n)=>`${t?`<span class=declare-param-type>${t}</span>`:""}&lt;<span class=declare-param-type>${n}</span>&gt;`)):U.test(e)?e.replace(U,((e,t,n)=>t?`<span class=declare-param>${t}</span>:<span class=declare-param-type>${n}</span>`:`:<span class=declare-param-type>${n}</span>`)):m(e)?Y(e):e}function Y(e){return e.replace(a,((e,t,n)=>`<span class=declare-function>${t}</span>${n}`))}function _(e){return e.replace(/(const|let|var|int|string)(\s+)/gi,((e,t,n)=>`<span class=declare-keyword>${t}</span><span class=declare-constant-name>${n}</span>`))}function ee(e){return e.replace(l,(e=>`<span class=declare-comments>${e}</span>`))}const te={java:function(e,t,n){let s="",r=e.split("\n");for(let e=0;e<r.length;e++){s+=L(r[e],t++,n)}return s},c:C,"c++":C,"c#":C,js:R,javascript:R,ts:M,typescript:M,html:function(e,t,n){if(/(<!--.*-->)/g.test(e))return`${S(t,n)}<span class=declare-comments>${O(RegExp.$1)}</span></p>`;if(/(\s*)<(\!?\w+)(.*)>(.*)<\/\w+>/g.test(e)){let e=Z(RegExp.$3.trim().split(" "));return`${S(t,n)}${RegExp.$1}&lt<span class=declare-html-tag>${RegExp.$2}</span>${e&&"&nbsp;"+e}&gt${RegExp.$4}&lt/<span class=declare-html-tag>${RegExp.$2}</span>&gt</p>`}if(/(\s*)<(\!?\w+)(.*)>/g.test(e)){let e=Z(RegExp.$3.trim().split(" "));return`${S(t,n)}${RegExp.$1}&lt<span class=declare-html-tag>${RegExp.$2}</span>${e&&"&nbsp;"+e}&gt</p>`}return/(\s*)<\/(\w+)>/g.test(e)?`${S(t,n)}${RegExp.$1}&lt/<span class=declare-html-tag>${RegExp.$2}</span>&gt</p>`:R(e,t++,n)}};function ne(e,t,n,s){let r="",l=e[t].slice(3).trim().toLowerCase(),a=1;for(++t;t<n&&!e[t].startsWith("```");)r+=s.highlight?te[l](e[t],a++,s):e[t]+"\n",t++;return e[t]="",{startIdx:t,result:s.highlight?`<pre><span class=language>${l}</span><code>${r}</code></pre>`:`<pre><code>${r}</code></pre>`}}function se(e,t,n){let s="";for(;t<n&&-1!=e[t].indexOf("-");t++)s+=e[t]+"\n";return s=function(e){const t=e.match(/(\s?)+-\s(.*)/g);if(!t)return e;c(t);const n=function(e){const t=[],n=[],s=e.length;for(let r=0;r<s;r++){const s=e[r].indexOf("-"),l={children:[],value:e[r].slice(s+1),level:s,parent:null};if(!n.length){t.push(l),n.push(l);continue}const a=n[n.length-1].level,c=e[r].indexOf("-");let i;if(a===c)i=n[n.length-1].parent;else if(a>c){for(;n[n.length-1].level>c;)n.pop();i=n[n.length-1].parent}else i=n[n.length-1];l.parent=i,i?i.children.push(l):t.push(l),n.push(l)}return t}(t);return i(n,!1)}(s),{startIdx:t,result:s}}function re(e,t,s){let r="";for(;t<s&&n.test(e[t]);t++)r+=e[t]+"\n";return r=function(e){const t=e.match(/\s*\d\.(.*)/g);if(!t)return e;c(t);const s=function(e){const t=[],s=[],r=e.length;for(let l=0;l<r;l++){let r=0;n.test(e[l])&&(r=e[l].indexOf(String(RegExp.$1+".")));const a={children:[],value:e[l].slice(r+2),level:r,parent:null};if(!s.length){t.push(a),s.push(a);continue}const c=s[s.length-1].level,i=r;let p;if(c===i)p=s[s.length-1].parent;else if(c>i){for(;s[s.length-1].level>i;)s.pop();p=s[s.length-1].parent}else p=s[s.length-1];a.parent=p,p?p.children.push(a):t.push(a),s.push(a)}return t}(t);return i(s,!0)}(r),{startIdx:t,result:r}}function le(e){return e.length>6?6:e.length}function ae(e,t,n){let s="<table>";for(s+=function(e){let t=-1,n="<thead><tr>";for(let s=0,r=e.length;s<r;s++)"|"==e[s]&&ie(e,s-1)&&ie(e,s+1)&&(-1!=t&&(n+=`<th>${e.slice(t+1,s)}</th>`),t=s);return n+"</tr></thead>"}(e[t]),s+="<tbody >",++t;t<n&&"|"===e[t].trim()[0];t++)s+=ce(e[t]);return s+="</tbody></table>",{startIdx:t-1,result:s}}function ce(e){let t=-1,n="<tr>";for(let s=0,r=e.length;s<r;s++)if("|"==e[s]&&ie(e,s-1)&&ie(e,s+1)){if(-1!=t){let r=e.slice(t+1,s);if("-"===r.trim()[0])continue;n+=`<td>${r}</td>`}t=s}return n+"</tr>"}function ie(e,t){return" "===e[t]||null==e[t]}function pe(e,t,n){let s="<div class=flex-layout>",r="";for(++t;t<n&&!e[t].startsWith("::: end");)E(e[t])?(s+=`<div class=flex-layout-item>${fe(r)}</div>`,r=""):r+=e[t].trim()?ue(e[t])+"\n":"",t++;return s+=`<div class=flex-layout-item>${fe(r)}</div>`,s+="</div>",{result:s,startIdx:t}}function ue(e){return"-"===e.trim()[0]||/^\d\./.test(e.trim())?e:`<p>${e}</p>`}const oe={lineNumber:!1,highlight:!1};function fe(n,s){const r=n.split("\n");let l="",a=(null==r?void 0:r.length)||0;for(let n=0;n<a;){if(-1!=r[n].indexOf("#")){l+=r[n].trim().replace(t,((e,t,n)=>`<h${le(t)}>${n}</h${le(t)}>`))}else if(I(r[n])){const{result:e,startIdx:t}=pe(r,n,a);n=t,l+=e}else if(h(r[n])){const{result:e,startIdx:t}=ae(r,n,a);n=t,l+=e}else if(u(r[n])){const{result:e,startIdx:t}=se(r,n,a);n=t,l+=e}else if(p(r[n])){const{result:e,startIdx:t}=re(r,n,a);n=t,l+=e}else if(o(r[n])){const{result:e,startIdx:t}=ne(r,n,a,s||oe);n=t,l+=e}else f(r[n])?l+=`<blockquote>${r[n].slice(2)}</blockquote>`:(r[n]=r[n].trim())&&(l+=e(r[n]));n++}return l}export{fe as markdownToHTML};
