function t(t,e=!1){let n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("**"));){e+=t.slice(0,n);let r=(t=t.slice(n+2)).indexOf("**");if(-1==r){t="**"+t;break}e+=`<strong>${t.slice(0,r)}</strong>`,t=t.slice(r+2)}return t&&(e+=t),e}(t);return n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("*"));){e+=t.slice(0,n);let r=(t=t.slice(n+1)).indexOf("*");if(-1==r){t="*"+t;break}e+=`<i>${t.slice(0,r)}</i>`,t=t.slice(r+1)}return t&&(e+=t),e}(n),n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("`"));){e+=t.slice(0,n);let r=(t=t.slice(n+1)).indexOf("`");if(-1==r){t="`"+t;break}e+=`<code class=single-code>${t.slice(0,r)}</code>`,t=t.slice(r+1)}return t&&(e+=t),e}(n),n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("~~"));){e+=t.slice(0,n);let r=(t=t.slice(n+2)).indexOf("~~");if(-1==r){t="~~"+t;break}e+=`<del>${t.slice(0,r)}</del>`,t=t.slice(r+2)}return t&&(e+=t),e}(n),n=function(t){let e="";for(;i.test(t);){let n=t.indexOf("![");e+=t.slice(0,n);let r=(t=t.slice(n+2)).indexOf("]("),i=t.slice(0,r),l=(t=t.slice(r+2)).indexOf(")"),s=t.slice(0,l);t=t.slice(l+1),e+=`<img alt=${i} src=${s} />`}return e+t}(n),n=function(t){let e="";for(;r.test(t);){let n=t.indexOf("[");e+=t.slice(0,n);let r=(t=t.slice(n+1)).indexOf("]("),i=t.slice(0,r),l=(t=t.slice(r+2)).indexOf(")"),s=t.slice(0,l);t=t.slice(l+1),e+=`<a href=${s} target="_blank">${i}</a>`}return e+t}(n),n=function(t){return t.replace(/icon:(\w+)(\s|\b)/g,((t,e)=>`<i class='iconfont icon-${e}'></i>`))}(n),n}const e=/^(#+)\s(.*)/g,n=/^\s*(\d+)\.\s(.+)/,r=/\[(.*)\]\((.*)\)/,i=/!\[(.*)\]\((.*)\)/;function l(t){/^\s+/.test(t[0])&&(t[0]=t[0].replace(/^(\s+)/g,(t=>"\n"))),t[0].startsWith("\n")||(t[0]="\n"+t[0])}function s(e,n){let r="";for(let i of e){let e=i.children.length?s(i.children,n):"";r+=`<li>${t(i.value+e,!0)}</li>`}return`<${n?"ol":"ul"}>${r}</${n?"ol":"ul"}>`}function c(t){return n.test(t)}function u(t){let e=t.indexOf("- ");return 0==e||-1!=e&&!t.slice(0,e).trim()}function o(t){return"#"===t.trimStart()[0]}function f(t){return t.startsWith("```")}function a(t){return/^>/.test(t.trim())}function d(t){return"---"===t.trim()}function h(t){return"|"===t.trim()[0]}function g(t){return"::: start"===t.trim()}function x(t){return":::"===t.trim()}function m(t){return"::: headStart"===t.trim()}function p(t){return"::: mainStart"===t.trim()}function O(t){return`<blockquote>${t.slice(1)}</blockquote>`}function b(t,e,n,r){let i="",l=t[e].slice(3).trim().toLowerCase();for(++e;e<n&&!t[e].startsWith("```");)i+=t[e]+"\n",e++;t[e]="";const s=[r.highlight?`language-${l}`:"",r.lineNumber?"line-numbers":""].join(" ");return i=`<pre><code ${s&&`class='${s}'`}>${i}</code></pre>`,{startIdx:e,result:i}}function $(t,e,n){let r="";for(;e<n;e++)if(t[e].trim()){if("-"!==t[e].trim()[0]||-1==t[e].indexOf("-"))break;r+=t[e]+"\n"}return r=function(t){const e=t.match(/(\s?)*-\s(.+)/g);if(!e)return t;l(e);const n=function(t){const e=[],n=[],r=t.length;for(let i=0;i<r;i++){const r=t[i].indexOf("- "),l={children:[],value:t[i].slice(r+2),level:r,parent:null};if(!n.length){e.push(l),n.push(l);continue}const s=n[n.length-1].level,c=t[i].indexOf("-");let u;if(s===c)u=n[n.length-1].parent;else if(s>c){for(;n[n.length-1].level>c;)n.pop();u=n[n.length-1].parent}else u=n[n.length-1];l.parent=u,u?u.children.push(l):e.push(l),n.push(l)}return e}(e);return s(n,!1)}(r),{startIdx:e,result:r}}function v(t,e,n){let r="";for(;e<n;e++)if(t[e].trim()){if(!c(t[e]))break;r+=t[e]+"\n"}return r=function(t){const e=t.match(/\s*\d+\.\s(.+)/g);if(!e)return t;l(e);const n=function(t){const e=[],n=[],r=t.length;for(let i=0;i<r;i++){let r=0;c(t[i])&&(r=t[i].indexOf(String(RegExp.$1+".")));const l={children:[],value:RegExp.$2,level:r,parent:null};if(!n.length){e.push(l),n.push(l);continue}const s=n[n.length-1].level,u=r;let o;if(s===u)o=n[n.length-1].parent;else if(s>u){for(;n[n.length-1].level>u;)n.pop();o=n[n.length-1].parent}else o=n[n.length-1];l.parent=o,o?o.children.push(l):e.push(l),n.push(l)}return e}(e);return s(n,!0)}(r),{startIdx:e,result:r}}function I(t){return t.length>6?6:t.length}function j(n){return n.trim().replace(e,((e,n,r)=>`<h${I(n)}>${t(r,!0)}</h${I(n)}>`))}function k(t,e,n){let r="<table>";for(r+=function(t){let e=-1,n="<thead><tr>";for(let r=0,i=t.length;r<i;r++)"|"==t[r]&&E(t,r-1)&&E(t,r+1)&&(-1!=e&&(n+=`<th>${t.slice(e+1,r)}</th>`),e=r);return n+"</tr></thead>"}(t[e]),r+="<tbody >",++e;e<n&&"|"===t[e].trim()[0];e++)r+=y(t[e]);return r+="</tbody></table>",{startIdx:e-1,result:r}}function y(t){let e=-1,n="<tr>";for(let r=0,i=t.length;r<i;r++)if("|"==t[r]&&E(t,r-1)&&E(t,r+1)){if(-1!=e){let i=t.slice(e+1,r);if("-"===i.trim()[0])continue;n+=`<td>${i}</td>`}e=r}return n+"</tr>"}function E(t,e){return" "===t[e]||null==t[e]}function S(t,e,n,r){let i="<div class=head-layout>",l="";for(++e;e<n&&"::: headEnd"!==t[e].trim();)t[e].trim()&&(l+=t[e]+"\n"),e++;return i+=N(l,Object.assign(Object.assign({},r),{xss:!1}))+"</div>",{result:i,startIdx:e}}function W(t,e,n,r){let i="<div class=flex-layout>",l="";for(++e;e<n&&"::: end"!==t[e].trim();){if(g(t[e])){const{result:i,startIdx:s}=W(t,e,n,r);l+=i,e=s}else if(m(t[e])){const{result:i,startIdx:s}=S(t,e,n,r);l+=i,e=s}else x(t[e])?(i+=`<div class=flex-layout-item>${N(l,Object.assign(Object.assign({},r),{xss:!1}))}</div>`,l=""):l+=t[e].trim()?"\n"+t[e]+"\n":"";e++}return i+=`<div class=flex-layout-item>${N(l,Object.assign(Object.assign({},r),{xss:!1}))}</div>`,i+="</div>",{result:i,startIdx:e}}function q(t,e,n,r){let i="<div class=main-layout>",l="";for(++e;e<n&&"::: mainEnd"!==t[e].trim();)t[e].trim()&&(l+=t[e]+"\n"),e++;return i+=N(l,Object.assign(Object.assign({},r),{xss:!1}))+"</div>",{result:i,startIdx:e}}const w={lineNumber:!1,highlight:!1,xss:!0};function N(e,n){let r=n||w,i="";r=Object.assign(Object.assign({},w),r);let l=r.xss?(x=e,x.replace(/</g,"&lt;")).split("\n"):e.split("\n"),s=(null==l?void 0:l.length)||0;var x,I;for(let e=0;e<s;){if(o(l[e]))i+=j(l[e]);else if(m(l[e])){const{result:t,startIdx:n}=S(l,e,s,r);e=n,i+=t}else if(p(l[e])){const{result:t,startIdx:n}=q(l,e,s,r);e=n,i+=t}else if(g(l[e])){const{result:t,startIdx:n}=W(l,e,s,r);e=n,i+=t}else if(d(l[e]))i+=3!==(I=l[e]).length?I:"---"===I?"<hr/>":I,++e;else if(h(l[e])){const{result:t,startIdx:n}=k(l,e,s);e=n,i+=t}else if(u(l[e])){const{result:t,startIdx:n}=$(l,e,s);e=n-1,i+=t}else if(c(l[e])){const{result:t,startIdx:n}=v(l,e,s);e=n-1,i+=t}else if(f(l[e])){const{result:t,startIdx:n}=b(l,e,s,r);e=n,i+=t}else a(l[e].trim())?i+=O(l[e].trim()):(l[e]=l[e].trim())&&(i+=t(l[e]));e++}return i}export{N as markdownToHTML};
