function t(t,e=!1){let n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("**"));){e+=t.slice(0,n);let i=(t=t.slice(n+2)).indexOf("**");if(-1==i){t="**"+t;break}e+=`<strong>${t.slice(0,i)}</strong>`,t=t.slice(i+2)}return t&&(e+=t),e}(t);return n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("*"));){e+=t.slice(0,n);let i=(t=t.slice(n+1)).indexOf("*");if(-1==i){t="*"+t;break}e+=`<i>${t.slice(0,i)}</i>`,t=t.slice(i+1)}return t&&(e+=t),e}(n),n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("`"));){e+=t.slice(0,n);let i=(t=t.slice(n+1)).indexOf("`");if(-1==i){t="`"+t;break}e+=`<code class=single-code>${t.slice(0,i)}</code>`,t=t.slice(i+1)}return t&&(e+=t),e}(n),n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("~~"));){e+=t.slice(0,n);let i=(t=t.slice(n+2)).indexOf("~~");if(-1==i){t="~~"+t;break}e+=`<del>${t.slice(0,i)}</del>`,t=t.slice(i+2)}return t&&(e+=t),e}(n),n=function(t){let e="";for(;r.test(t);){let n=t.indexOf("![");e+=t.slice(0,n);let i=(t=t.slice(n+2)).indexOf("]("),r=t.slice(0,i),l=(t=t.slice(i+2)).indexOf(")"),s=t.slice(0,l);t=t.slice(l+1),e+=`<p><img alt=${r} src=${s} /></p>`}return e+t}(n),n=function(t){let e="";for(;i.test(t);){let n=t.indexOf("[");e+=t.slice(0,n);let i=(t=t.slice(n+1)).indexOf("]("),r=t.slice(0,i),l=(t=t.slice(i+2)).indexOf(")"),s=t.slice(0,l);t=t.slice(l+1),e+=`<a href=${s}>${r}</a>`}return e+t}(n),n=function(t){return t.replace(/icon:(\w+)(\s|\b)/g,((t,e)=>`<i class='iconfont icon-${e}'></i>`))}(n),e?n:`<p>${n}</p>`}const e=/(#+)\s(.*)/g,n=/^\s*(\d)\./,i=/\[(.*)\]\((.*)\)/,r=/!\[(.*)\]\((.*)\)/;function l(t){/^\s+/.test(t[0])&&(t[0]=t[0].replace(/^(\s+)/g,(t=>"\n"))),t[0].startsWith("\n")||(t[0]="\n"+t[0])}function s(e,n){let i="";for(let r of e){let e=r.children.length?s(r.children,n):"";i+=`<li>${t(r.value+e,!0)}</li>`}return`<${n?"ol":"ul"}>${i}</${n?"ol":"ul"}>`}function c(t){return n.test(t)}function u(t){let e=t.indexOf("-");return 0==e||-1!=e&&!t.slice(0,e).trim()}function o(t){return-1!=t.indexOf("#")}function f(t){return t.startsWith("```")}function a(t){return t.startsWith("> ")}function d(t){return"---"===t.trim()}function h(t){return"|"===t.trim()[0]}function g(t){return"::: start"===t.trim()}function x(t){return":::"===t.trim()}function p(t){return"::: headStart"===t.trim()}function m(t){return"::: mainStart"===t.trim()}function O(t){return`<blockquote>${t.slice(2)}</blockquote>`}function $(t,e,n,i){let r="",l=t[e].slice(3).trim().toLowerCase();for(++e;e<n&&!t[e].startsWith("```");)r+=t[e]+"\n",e++;t[e]="";const s=[i.highlight?`language-${l}`:"",i.lineNumber?"line-numbers":""].join(" ");return r=`<pre><code ${s&&`class='${s}'`}>${r}</code></pre>`,{startIdx:e,result:r}}function b(t,e,n){let i="";for(;e<n;e++)if(t[e].trim()){if("-"!==t[e].trim()[0]||-1==t[e].indexOf("-"))break;i+=t[e]+"\n"}return i=function(t){const e=t.match(/(\s?)+-\s(.*)/g);if(!e)return t;l(e);const n=function(t){const e=[],n=[],i=t.length;for(let r=0;r<i;r++){const i=t[r].indexOf("-"),l={children:[],value:t[r].slice(i+1),level:i,parent:null};if(!n.length){e.push(l),n.push(l);continue}const s=n[n.length-1].level,c=t[r].indexOf("-");let u;if(s===c)u=n[n.length-1].parent;else if(s>c){for(;n[n.length-1].level>c;)n.pop();u=n[n.length-1].parent}else u=n[n.length-1];l.parent=u,u?u.children.push(l):e.push(l),n.push(l)}return e}(e);return s(n,!1)}(i),{startIdx:e,result:i}}function v(t,e,i){let r="";for(;e<i;e++)if(t[e].trim()){if(!n.test(t[e]))break;r+=t[e]+"\n"}return r=function(t){const e=t.match(/\s*\d\.(.*)/g);if(!e)return t;l(e);const i=function(t){const e=[],i=[],r=t.length;for(let l=0;l<r;l++){let r=0;n.test(t[l])&&(r=t[l].indexOf(String(RegExp.$1+".")));const s={children:[],value:t[l].slice(r+2),level:r,parent:null};if(!i.length){e.push(s),i.push(s);continue}const c=i[i.length-1].level,u=r;let o;if(c===u)o=i[i.length-1].parent;else if(c>u){for(;i[i.length-1].level>u;)i.pop();o=i[i.length-1].parent}else o=i[i.length-1];s.parent=o,o?o.children.push(s):e.push(s),i.push(s)}return e}(e);return s(i,!0)}(r),{startIdx:e,result:r}}function I(t){return t.length>6?6:t.length}function j(n){return n.trim().replace(e,((e,n,i)=>`<h${I(n)}>${t(i,!0)}</h${I(n)}>`))}function k(t,e,n){let i="<table>";for(i+=function(t){let e=-1,n="<thead><tr>";for(let i=0,r=t.length;i<r;i++)"|"==t[i]&&W(t,i-1)&&W(t,i+1)&&(-1!=e&&(n+=`<th>${t.slice(e+1,i)}</th>`),e=i);return n+"</tr></thead>"}(t[e]),i+="<tbody >",++e;e<n&&"|"===t[e].trim()[0];e++)i+=y(t[e]);return i+="</tbody></table>",{startIdx:e-1,result:i}}function y(t){let e=-1,n="<tr>";for(let i=0,r=t.length;i<r;i++)if("|"==t[i]&&W(t,i-1)&&W(t,i+1)){if(-1!=e){let r=t.slice(e+1,i);if("-"===r.trim()[0])continue;n+=`<td>${r}</td>`}e=i}return n+"</tr>"}function W(t,e){return" "===t[e]||null==t[e]}function E(t,e,n,i){let r="<div class=head-layout>",l="";for(++e;e<n&&"::: headEnd"!==t[e].trim();)t[e].trim()&&(l+=t[e]+"\n"),e++;return r+=N(l,Object.assign(Object.assign({},i),{xss:!1}))+"</div>",{result:r,startIdx:e}}function S(t,e,n,i){let r="<div class=flex-layout>",l="";for(++e;e<n&&"::: end"!==t[e].trim();){if(g(t[e])){const{result:r,startIdx:s}=S(t,e,n,i);l+=r,e=s}else if(p(t[e])){const{result:r,startIdx:s}=E(t,e,n,i);l+=r,e=s}else x(t[e])?(r+=`<div class=flex-layout-item>${N(l,Object.assign(Object.assign({},i),{xss:!1}))}</div>`,l=""):l+=t[e].trim()?"\n"+t[e]+"\n":"";e++}return r+=`<div class=flex-layout-item>${N(l,Object.assign(Object.assign({},i),{xss:!1}))}</div>`,r+="</div>",{result:r,startIdx:e}}function q(t,e,n,i){let r="<div class=main-layout>",l="";for(++e;e<n&&"::: mainEnd"!==t[e].trim();)t[e].trim()&&(l+=t[e]+"\n"),e++;return r+=N(l,Object.assign(Object.assign({},i),{xss:!1}))+"</div>",{result:r,startIdx:e}}const w={lineNumber:!1,highlight:!1,xss:!0};function N(e,n){let i=n||w,r="";i=Object.assign(Object.assign({},w),i);let l=i.xss?(x=e,x.replace(/</g,"&lt;").replace(/>/g,"&gt;")).split("\n"):e.split("\n"),s=(null==l?void 0:l.length)||0;var x,I;for(let e=0;e<s;){if(o(l[e]))r+=j(l[e]);else if(p(l[e])){const{result:t,startIdx:n}=E(l,e,s,i);e=n,r+=t}else if(m(l[e])){const{result:t,startIdx:n}=q(l,e,s,i);e=n,r+=t}else if(g(l[e])){const{result:t,startIdx:n}=S(l,e,s,i);e=n,r+=t}else if(d(l[e]))r+=3!==(I=l[e]).length?I:"---"===I?"<hr/>":I,++e;else if(h(l[e])){const{result:t,startIdx:n}=k(l,e,s);e=n,r+=t}else if(u(l[e])){const{result:t,startIdx:n}=b(l,e,s);e=n-1,r+=t}else if(c(l[e])){const{result:t,startIdx:n}=v(l,e,s);e=n-1,r+=t}else if(f(l[e])){const{result:t,startIdx:n}=$(l,e,s,i);e=n,r+=t}else a(l[e])?r+=O(l[e]):(l[e]=l[e].trim())&&(r+=t(l[e]));e++}return r}export{N as markdownToHTML};
